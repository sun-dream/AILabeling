<!-- Top Bar -->
<div class="bg-secondary text-border text-xs py-2 hidden lg:block relative z-10">
    <div class="container mx-auto px-4 flex justify-between items-center">
        <!-- Address & Hours -->
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-2">
                <i data-lucide="map-pin" class="w-4 h-4 text-white"></i>
                <span>99 Wall St Suite 172, New York</span>
            </div>
            <div class="flex items-center gap-2">
                <i data-lucide="clock" class="w-4 h-4 text-white"></i>
                <span>Mon-Fri from 8am to 5pm.</span>
            </div>
            <div class="flex items-center gap-4">
                <a href="tel:+1-347-495-4959" class="hover:text-white transition-colors flex items-center gap-1">
                    <i data-lucide="phone" class="w-3 h-3 text-white"></i> +1-347-495-4959
                </a>
                <a href="tel:+1-718-550-2779" class="hover:text-white transition-colors flex items-center gap-1">
                    <i data-lucide="phone" class="w-3 h-3 text-white"></i> +1-718-550-2779
                </a>
            </div>
            <a href="mailto:zicklin@zicklincontracting.com"
                class="flex items-center gap-2 hover:text-white transition-colors">
                <i data-lucide="mail" class="w-3 h-3 text-white"></i> zicklin@zicklincontracting.com
            </a>
        </div>
        <!-- Contact Info -->
        <div class="flex items-center gap-6">

            <div class="flex items-center gap-3">
                <a href="#" aria-label="WhatsApp" class="hover:opacity-80 transition-opacity text-white">
                    <svg viewBox="0 0 24 24" fill="currentColor" class="w-4 h-4">
                        <path
                            d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
                    </svg>
                </a>
                <a href="#" aria-label="Facebook" class="hover:opacity-80 transition-opacity text-white">
                    <i data-lucide="facebook" class="w-4 h-4"></i>
                </a>
                <a href="#" aria-label="Twitter" class="hover:opacity-80 transition-opacity text-white">
                    <i data-lucide="twitter" class="w-4 h-4"></i>
                </a>
                <a href="#" aria-label="Instagram" class="hover:opacity-80 transition-opacity text-white">
                    <i data-lucide="instagram" class="w-4 h-4"></i>
                </a>
            </div>
        </div>
    </div>
</div>
<!-- Main Header -->
<nav id="main-nav" class="md:bg-white bg-secondary border-b border-border relative z-40 transition-all duration-300">
    <div class="container mx-auto px-2 lg:px-4">
        <div class="flex justify-between items-center h-20">
            <div class="flex items-center">
                <!-- Logo -->
                <a href="/" class="flex-shrink-0">
                    <img src="https://aidp.juejin.cn/agentic/api/v1/tool/text2image?prompt=ZICKLIN%20CONTRACTING%20%E7%9A%84%E5%93%81%E7%89%8C%20Logo%EF%BC%9A%E5%B7%A6%E4%BE%A7%E6%A0%87%E8%AF%86%EF%BC%9A%E7%BA%A2%E5%BA%95%E7%99%BD%E8%89%B2%E7%9A%84%E5%9B%BE%E5%BD%A2%EF%BC%8C%E6%98%AF%20%E6%88%BF%E5%B1%8B%E8%BD%AE%E5%BB%93%20%2B%20%E5%B7%A5%E5%85%B7%EF%BC%88%E7%B1%BB%E4%BC%BC%E9%94%A4%E5%AD%90%20%2F%20%E6%92%AC%E6%A3%8D%EF%BC%89%20%E7%9A%84%E7%BB%84%E5%90%88%E9%80%A0%E5%9E%8B%EF%BC%8C%E7%9B%B4%E8%A7%82%E4%BD%93%E7%8E%B0%E5%BB%BA%E7%AD%91%E3%80%81%E7%BB%B4%E4%BF%AE%E7%B1%BB%E4%B8%9A%E5%8A%A1%E5%B1%9E%E6%80%A7%E3%80%82%20%E5%8F%B3%E4%BE%A7%E6%96%87%E5%AD%97%EF%BC%9A%E4%B8%BB%E5%90%8D%E7%A7%B0%20ZICKLIN%20%E7%94%A8%E7%B2%97%E9%BB%91%E7%9A%84%E6%97%A0%E8%A1%AC%E7%BA%BF%E5%AD%97%E4%BD%93%EF%BC%9B%E4%B8%8B%E6%96%B9%20CONTRACTING%E7%94%A8%E6%9A%97%E7%BA%A2%E8%89%B2%E5%AD%97%E4%BD%93%EF%BC%8C%E4%B8%8E%E5%B7%A6%E4%BE%A7%E5%BA%95%E8%89%B2%E5%91%BC%E5%BA%94%EF%BC%9B%E6%9C%80%E5%BA%95%E9%83%A8%E7%9A%84%20WATERPROOFING%20AND%20RESTORATION%E7%94%A8%E9%BB%91%E8%89%B2%E5%B0%8F%E5%AD%97%E4%BD%93%EF%BC%8C%E6%98%8E%E7%A1%AE%E4%BA%86%E4%B8%9A%E5%8A%A1%E8%8C%83%E5%9B%B4%E3%80%82%20%E6%B3%A8%E6%84%8F!!%20%E7%99%BD%E8%89%B2%E8%83%8C%E6%99%AF%EF%BC%8C%E5%9B%BE%E7%89%87%E4%B8%AD%E4%B8%8D%E8%83%BD%E6%9C%89%E4%B8%AD%E6%96%87%EF%BC%8C%E5%9B%BE%E7%89%87%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%AE%BD%E5%BA%A6%E8%87%B3%E5%B0%91%E5%8D%A0%E6%95%B4%E4%B8%AA%E5%9B%BE%E5%AE%BD%E5%BA%A6%E7%9A%8490%25&width=206&height=64"
                        alt="Zicklin Contracting" class="w-[160px] h-12  object-cover">
                </a>
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-8 h-full ml-10">
                    <!-- Services Mega Menu -->
                    <div class="group h-full flex items-center relative">
                        <a href="#"
                            class="text-secondary font-maven text-lg hover:text-primary transition-colors flex items-center gap-1 py-8 font-medium">
                            Services
                            <i data-lucide="chevron-down" class="w-4 h-4"></i>
                        </a>
                        <!-- Mega Menu Dropdown -->
                        <div id="mega-menu-container" style="display: none;"
                            class="w-[940px] absolute top-full left-0 bg-white shadow-xl border-t-4 border-primary z-50 opacity-0 invisible pointer-events-none group-hover:opacity-100 group-hover:visible group-hover:pointer-events-auto transition-all duration-300 transform origin-top translate-y-2 group-hover:translate-y-0">
                            <!-- JS will inject content here -->
                        </div>
                    </div>
                    <a href="#customer-showcase"
                        class="text-secondary font-maven text-lg hover:text-primary transition-colors font-medium">Projects</a>
                    <a href="#service-intro-text"
                        class="text-secondary font-maven text-lg hover:text-primary transition-colors font-medium">About
                        Us</a>
                    <a href="#contact-text-form"
                        class="text-secondary font-maven text-lg hover:text-primary transition-colors font-medium">Contact
                        Us</a>
                </div>
            </div>
            <a href="tel:+1-347-495-4959"
                class="hidden md:flex items-center bg-primary text-white px-6 py-3 rounded hover:bg-opacity-90 transition-colors font-bold shadow-sm hover:shadow-md flex items-center gap-2">
                <i data-lucide="phone" class="w-4 h-4"></i>
                Emergency Call
            </a>
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" class="md:hidden md:text-secondary text-white  p-2  rounded">
                <i data-lucide="menu" class="w-6 h-6 icon-menu"></i>
                <i data-lucide="x" class="w-6 h-6 icon-close hidden"></i>
            </button>
        </div>
    </div>
    <!-- Mobile Menu (Hidden by default) -->
    <div id="mobile-menu"
        class="hidden lg:hidden bg-white border-t border-border absolute top-full left-0 w-full shadow-lg h-[calc(100vh-80px)] overflow-y-auto">
        <div class="container mx-auto px-4 py-4 flex flex-col gap-4">
            <!-- Services Accordion -->
            <div class="border-b border-border pb-2">
                <button id="mobile-services-toggle"
                    class="w-full flex justify-between items-center text-secondary font-maven text-lg py-2">
                    Services
                    <i data-lucide="chevron-down" class="w-5 h-5 transition-transform duration-300"></i>
                </button>
                <div id="mobile-services-content"
                    class="overflow-hidden transition-all duration-300 ease-in-out max-h-0 pl-2 space-y-2">
                    <!-- JS will inject content here -->
                </div>
            </div>
            <a href="#customer-showcase"
                class="text-secondary font-maven text-lg py-2 border-b border-border">Projects</a>
            <a href="#service-intro-text" class="text-secondary font-maven text-lg py-2 border-b border-border">About
                Us</a>
            <a href="#contact-text-form" class="text-secondary font-maven text-lg py-2 border-b border-border">Contact
                Us</a>
            <div class="mt-4 flex flex-col gap-3">
                <a href="tel:+1-347-495-4959" class="bg-primary text-white px-6 py-3 rounded text-center font-bold">
                    Call Now
                </a>
            </div>
        </div>
    </div>
</nav>

<script>
    // Mega Menu 数据
    const servicesData = [
        {
            id: 'renovations',
            title: 'Renovations & Remodeling',
            icon: 'hammer',
            description: 'Refresh your interiors for a new look',
            items: [
                { icon: 'home', title: 'Home Renovation NYC', desc: 'Three decades of experience in providing complete house renovation', link: '#' },
                { icon: 'layers', title: 'NYC Basement Remodeling', desc: 'Converting basements into livable spaces like home theaters, gyms, guest suites, or rental units.', link: '#' },
                { icon: 'utensils', title: 'Kitchen Remodeling NYC', desc: 'Identification and repair of leaks in walls, ceilings, and plumbing systems.', link: '#' },
                { icon: 'align-justify', title: 'Vinyl Flooring', desc: 'Discover the Unparalleled Beauty and Durability of Vinyl Flooring in New York.', link: '#' },
                { icon: 'hammer', title: 'Gut Renovation', desc: 'Experience the Zicklin Difference in Manhattan, Brooklyn & Queens', link: '#' },
                { icon: 'droplets', title: 'NYC Bathroom Remodeling', desc: 'Basement, roof, and exterior waterproofing solutions with lifetime warranties.', link: '#' },
                { icon: 'bed', title: 'Bedroom Remodeling', desc: 'Create Your Perfect Sanctuary in the City That Never Sleeps with Zicklin Contracting.', link: '#' },
                { icon: 'sofa', title: 'Living Room Remodeling', desc: 'Enhance the space by updating design elements like flooring, furniture, and lighting.', link: '#' },
                { icon: 'sun', title: 'Exterior Renovation NYC', desc: 'Professional exterior renovations add beauty & value to your home through services that include siding, window installation, & landscaping.', link: '#' },
                { icon: 'brick-wall', title: 'Masonry NYC', desc: 'Professional masonry work in brick, stucco, concrete, and stone raises the value and beauty of Properties.', link: '#' },
                { icon: 'layout-grid', title: 'Pavers NYC', desc: 'Paver installation in driveways, walkways, patios, and pools gives you professional finishes that add aesthetic appeal.', link: '#' }
            ]
        },
        {
            id: 'roofing',
            title: 'Roofing & Structural Services',
            icon: 'umbrella',
            description: 'Protect and repair with confidence',
            items: [
                { icon: 'shield', title: 'Roofing', desc: 'Installation, repair, and maintenance of roofs. Specialize in energy-efficient, metal, and solar roofing options.', link: '#' },
                { icon: 'plus-square', title: 'New Roof NYC', desc: 'We provide new roof installations with high-quality materials and attention to detail for long-lasting results.', link: '#' },
                { icon: 'wrench', title: 'Roof Repairs NYC', desc: 'Expert repair services to address leaks, structural issues, and other roof-related problems.', link: '#' },
                { icon: 'layout', title: 'Premier Flat Roof Solutions', desc: 'Get durable, energy-efficient flat roofing solutions with expert services across NYC.', link: '#' },
                { icon: 'clipboard-check', title: 'Roof Evaluation NYC', desc: 'Comprehensive assessment of your roof’s condition to identify necessary repairs or maintenance.', link: '#' },
                { icon: 'sun', title: 'Skylight Roofing NYC', desc: 'Installation and repair of skylights to enhance natural light and ventilation.', link: '#' },
                { icon: 'tool', title: 'Roof Structural Maintenance', desc: 'Ongoing maintenance to ensure the structural integrity of your roof over time.', link: '#' },
                { icon: 'building', title: 'Expert Structural Repairs', desc: 'Expert structural repairs for beams, foundations, and floors in NYC.', link: '#' }
            ]
        },
        {
            id: 'repairs',
            title: 'Repairs & Fixes',
            icon: 'wrench',
            description: 'Ensure full compliance with ease',
            items: [
                { icon: 'footprints', title: 'Sidewalk Violation', desc: 'Address and correct DOT-mandated sidewalk repairs. Ensure compliance and avoid fines.', link: '#' },
                { icon: 'wrench', title: 'Roof Repairs NYC', desc: 'Repair roof damage and improve its performance with expert solutions.', link: '#' },
                { icon: 'search', title: 'Leak Detection', desc: 'Use advanced thermal imaging technology to detect leaks in walls, ceilings, and plumbing systems.', link: '#' },
                { icon: 'droplets', title: 'NYC Waterproofing', desc: 'Basement, roof, and exterior waterproofing solutions with lifetime warranties.', link: '#' },
                { icon: 'building', title: 'Structural Repairs', desc: 'Repair structural issues to ensure the safety and stability of your property.', link: '#' },
                { icon: 'file-text', title: 'Sidewalk Repair Process NYC', desc: 'Get NYC Sidewalk Repairs Done Right', link: '#' }
            ]
        },
        {
            id: 'safety',
            title: 'Safety & Compliance Services',
            icon: 'shield-check',
            description: 'Ensure full compliance with ease',
            items: [
                { icon: 'file-text', title: 'Local Law Compliance', desc: 'Make sure your building is compliant with the Local Law 10/11 through our inspection process.', link: '#' },
                { icon: 'zap', title: 'Energy Code Compliance', desc: 'Navigate complex NYSECCC requirements with confidence and deliver exceptional energy-efficient construction projects', link: '#' },
                { icon: 'file-check', title: 'Permit and Documentation Services', desc: 'Manage all necessary permits and legal documentation. Ensure smooth project progression with legal approval from the start.', link: '#' },
                { icon: 'file-check', title: 'Local Law 152', desc: 'Zicklin Contracting specializes in ensuring that your building complies with all Local Law 152 (LL152) standards.', link: '#' },
                { icon: 'alert-triangle', title: 'Expert Help for NYC DEP Violations', desc: 'ZickLin Contracting facilitates quick resolution of DEP violations in New York City.', link: '#' },
                { icon: 'hammer', title: 'Professional Alterations and Demolitions', desc: 'Zicklin Contracting offers expert NYC demolition and alteration services, focusing on safety, quality, and efficiency.', link: '#' },
                { icon: 'hard-hat', title: 'Experienced Demolition Contractors', desc: 'Zicklin Contracting handles NYC demolition permits, ensuring compliance with regulations and efficiency.', link: '#' },
                { icon: 'alert-circle', title: 'Sidewalk Repair Violations NYC', desc: 'Manage and correct curb violations.Compliance with city regulations to prevent penalties.', link: '#' },
                { icon: 'x-circle', title: 'DOB Violation Removal', desc: 'Removal of Department of Buildings (DOB) violations and Other Municipal Violations. Navigate the process to bring properties into compliance.', link: '#' },
                { icon: 'eye', title: 'Annual Parapet Wall Inspections', desc: 'Keep your building safe and compliant with professional parapet inspections.', link: '#' },
                { icon: 'search', title: 'Comprehensive Facade Inspection Services', desc: 'Ensure compliance with Local Law 11 NYC. Expert facade inspections, SWARMP solutions, and repairs for safe and compliant buildings', link: '#' },
                { icon: 'gavel', title: 'Expert ECB Violation Hearing Services', desc: 'Zicklin Contracting helps resolve NYC ECB violations, offering legal solutions and compliance support.', link: '#' },
                { icon: 'badge-check', title: 'NYC Licensed Contractors', desc: 'Zicklin Contracting assists with obtaining NYC general contractor licenses, ensuring full legal compliance.', link: '#' }
            ]
        },
        {
            id: 'damage',
            title: 'Damage Restoration & Claims',
            icon: 'flame',
            description: 'Expert restoration and claims assistance',
            items: [
                { icon: 'droplets', title: 'Water Damage Claims', desc: 'Assistance with filing and managing insurance claims for water damage. Provide full support from assessment to restoration.', link: '#' },
                { icon: 'waves', title: 'Water Damage Restoration NYC', desc: 'Comprehensive water damage restoration services to mitigate damage and prevent future issues.', link: '#' },
                { icon: 'flame', title: 'Fire Damage Claims', desc: 'Manage insurance claims for fire damage. Handle everything from initial damage assessment to completing the necessary repairs.', link: '#' },
                { icon: 'pipette', title: 'Pipe Burst Claims', desc: 'When tragedy strikes with a burst pipe in New York City, Zicklin Contracting is your professional claims assistance and restoration company of choice.', link: '#' },
                { icon: 'wind', title: 'Mold Remediation Claims', desc: 'Assistance with insurance claims related to mold issues. Provide end-to-end services from detection and remediation to insurance negotiation.', link: '#' },
                { icon: 'file-text', title: 'Insurance Claim Assistance', desc: 'Professional assistance in managing insurance claims for damage restoration, ensuring you receive the maximum compensation for necessary repairs.', link: '#' },
                { icon: 'umbrella', title: 'Flood Mitigation Claims', desc: 'We bring decades of expertise and innovative technologies to provide efficient, timely flood mitigation services.', link: '#' },
                { icon: 'zap', title: 'Electrical Fire Claims', desc: 'Expert guidance for electrical fire claims in New York City, helping you rebuild and recover.', link: '#' },
                { icon: 'trash-2', title: 'Sewer Backup Claims', desc: 'When disaster strikes with sewer backup in New York, Zicklin Contracting stands ready to help.', link: '#' }
            ]
        },
        {
            id: 'contact',
            title: 'Contact Us',
            icon: 'phone',
            description: 'Feel free to reach out with any questions',
            items: [
                { icon: 'mail', title: 'General Inquiry', desc: 'Have a question? Send us a message.', link: '#contact-text-form' },
                { icon: 'file-text', title: 'Get a Quote', desc: 'Request a free estimate for your project.', link: '#contact-text-form' },
                { icon: 'phone-call', title: 'Emergency Service', desc: '24/7 emergency response available.', link: 'tel:+1-347-495-4959' }
            ]
        }
    ];
    // Mega Menu 交互逻辑
    function initMegaMenu() {
        const container = document.getElementById('mega-menu-container');
        if (!container) return;
        // 渲染 Mega Menu 内容
        renderMegaMenu(container);
        // 渲染完成后，移除 display: none，允许 CSS 控制显隐
        // 使用 setTimeout 确保渲染帧已更新，防止 FOUC
        setTimeout(() => (container.style.display = ''), 100);
        const triggers = container.querySelectorAll('.mega-menu-trigger');
        const contents = container.querySelectorAll('.mega-menu-content');
        // 辅助函数：切换 Tab
        function switchTab(targetId) {
            // 重置所有 Trigger 样式
            triggers.forEach(t => {
                t.classList.remove('bg-white', 'text-primary', 'border-l-4', 'border-primary', 'shadow-sm');
                t.classList.add('border-l-4', 'border-transparent', 'text-secondary');

                // 重置图标颜色
                const icon = t.querySelector('.trigger-icon');
                if (icon) {
                    icon.classList.remove('text-primary');
                    icon.classList.add('text-gray-400');
                }
            });
            // 隐藏所有 Content
            contents.forEach(c => {
                c.classList.add('hidden');
            });
            // 激活当前 Trigger
            const currentTrigger = container.querySelector(`.mega-menu-trigger[data-target="${targetId}"]`);
            if (currentTrigger) {
                currentTrigger.classList.remove('border-transparent', 'text-secondary');
                currentTrigger.classList.add('bg-white', 'text-primary', 'border-primary', 'shadow-sm');
                // 激活图标颜色
                const icon = currentTrigger.querySelector('.trigger-icon');
                if (icon) {
                    icon.classList.remove('text-gray-400');
                    icon.classList.add('text-primary');
                }
            }
            // 显示当前 Content
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
                targetContent.classList.remove('hidden');
            }
        }
        triggers.forEach(trigger => {
            trigger.addEventListener('mouseenter', () => {
                const targetId = trigger.getAttribute('data-target');
                switchTab(targetId);
            });
        });
        // 初始化默认选中第一个
        if (triggers.length > 0) {
            const firstTargetId = triggers[0].getAttribute('data-target');
            switchTab(firstTargetId);
        }
    }
    // 渲染 Mega Menu HTML
    function renderMegaMenu(container) {
        let sidebarHtml = '';
        let contentHtml = '';
        servicesData.forEach((category, index) => {
            // 生成 Sidebar Item
            sidebarHtml += `
            <div class="mega-menu-trigger w-full flex items-center gap-3 px-6 py-4 cursor-pointer transition-all duration-200 border-l-4 border-transparent hover:bg-white hover:text-primary group" data-target="mega-content-${category.id}">
                <i data-lucide="${category.icon}" class="trigger-icon w-5 h-5 text-gray-400 group-hover:text-primary transition-colors"></i>
                <div class="flex-1">
                    <div class="font-bold text-base">${category.title}</div>
                    <div class="text-xs text-gray-400 mt-0.5 hover:text-primary/70 line-clamp-1">${category.description}</div>
                </div>
                <i data-lucide="chevron-right" class="w-4 h-4 opacity-0 group-hover:opacity-100 transition-opacity text-primary"></i>
            </div>
        `;
            // 生成 Content Item (Grid Layout)
            contentHtml += `
            <div id="mega-content-${category.id}" class="mega-menu-content hidden h-full overflow-y-auto custom-scrollbar">
                <div class="grid grid-cols-2 gap-x-8 gap-y-6">
                    ${category.items.map(item => `
                        <a href="${item.link}" class="flex items-start gap-3 group/item p-2 rounded-lg hover:bg-gray-50 transition-colors">
                            <div class="mt-1 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 group-hover/item:bg-primary group-hover/item:text-white transition-colors">
                                <i data-lucide="${item.icon}" class="w-4 h-4 text-primary group-hover/item:text-white transition-colors"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-sm text-secondary group-hover/item:text-primary transition-colors">${item.title}</h4>
                                <p class="text-xs text-gray-500 mt-1 leading-relaxed line-clamp-2">${item.desc}</p>
                            </div>
                        </a>
                    `).join('')}
                </div>
            </div>
        `;
        });
        const fullHtml = `
        <div class="flex bg-white rounded-b-lg overflow-hidden">
            <!-- Sidebar (Left) -->
            <div class="w-[300px] bg-gray-50 flex-shrink-0 py-4 overflow-y-auto border-r border-gray-100">
                ${sidebarHtml}
            </div>
            <!-- Content (Right - 2 Columns) -->
            <div class="flex-1 p-8 bg-white">
                ${contentHtml}
            </div>
        </div>
    `;
        container.innerHTML = fullHtml;
    }

    // 移动端菜单逻辑
    function initMobileMenu() {
        const mobileServicesContent = document.getElementById('mobile-services-content');
        if (!mobileServicesContent) return;
        // 渲染服务列表
        let html = '';
        servicesData.forEach(category => {
            html += `
            <div class="border-b border-gray-100 last:border-0">
                <button class="mobile-service-category w-full flex justify-between items-start py-3 text-secondary hover:text-primary transition-colors text-left">
                    <div class="flex gap-3">
                        <i data-lucide="${category.icon}" class="w-5 h-5 text-primary mt-1 flex-shrink-0"></i>
                        <div>
                            <div class="font-bold text-base">${category.title}</div>
                            <div class="text-xs text-gray-500 mt-1 font-normal">${category.description}</div>
                        </div>
                    </div>
                    <i data-lucide="chevron-down" class="w-4 h-4 transition-transform duration-300 mt-1"></i>
                </button>
                <div class="overflow-hidden transition-all duration-300 ease-in-out max-h-0 bg-gray-50">
                    <div class="pl-8 pr-4 py-4 space-y-4">
                        ${category.items.map(item => `
                            <a href="${item.link}" class="block group">
                                <div class="font-bold text-sm text-secondary group-hover:text-primary transition-colors mb-1">
                                    ${item.title}
                                </div>
                                <div class="text-xs text-gray-500 leading-relaxed">
                                    ${item.desc}
                                </div>
                            </a>
                        `).join('')}
                    </div>
                </div>
            </div>
        `;
        });
        mobileServicesContent.innerHTML = html;

        // 辅助函数：手风琴切换
        function toggleAccordion(element, icon) {
            if (element.style.maxHeight && element.style.maxHeight !== '0px') {
                // 关闭
                element.style.maxHeight = element.scrollHeight + 'px'; // 设置固定高度以便过渡
                element.offsetHeight; // 强制重绘
                element.style.maxHeight = '0px';
                if (icon) icon.classList.remove('rotate-180');
            } else {
                // 打开
                element.style.maxHeight = element.scrollHeight + 'px';
                if (icon) icon.classList.add('rotate-180');

                element.addEventListener('transitionend', function () {
                    if (element.style.maxHeight !== '0px') {
                        element.style.maxHeight = 'none';
                    }
                }, { once: true });
            }
        }
        // 绑定事件
        // 1. 主 Services 展开/收起
        const mobileServicesToggle = document.getElementById('mobile-services-toggle');
        if (mobileServicesToggle) {
            mobileServicesToggle.addEventListener('click', function () {
                const content = document.getElementById('mobile-services-content');
                const icon = this.querySelector('i[data-lucide="chevron-down"]');
                if (content.style.maxHeight === 'none') {
                    content.style.maxHeight = content.scrollHeight + 'px';
                    content.offsetHeight; // 强制重绘
                }
                toggleAccordion(content, icon);
            });
        }
        // 2. 子分类展开/收起
        const categoryButtons = document.querySelectorAll('.mobile-service-category');
        categoryButtons.forEach(btn => {
            btn.addEventListener('click', function () {
                const content = this.nextElementSibling;
                const icon = this.querySelector('i[data-lucide="chevron-down"]');
                if (content.style.maxHeight === 'none') {
                    content.style.maxHeight = content.scrollHeight + 'px';
                    content.offsetHeight;
                }

                toggleAccordion(content, icon);
            });
        });
    }
    // 移动端菜单切换逻辑
    function initMobileToggle() {
        const btn = document.getElementById('mobile-menu-btn');
        const menu = document.getElementById('mobile-menu');
        if (btn && menu) {
            btn.addEventListener('click', function () {
                menu.classList.toggle('hidden');
                // 切换图标
                // 注意：Lucide 会将 i 标签替换为 svg，所以我们需要查找具有对应 class 的元素
                // 查找时可能已经是 svg 了
                let iconMenu = btn.querySelector('.icon-menu');
                let iconClose = btn.querySelector('.icon-close');

                if (iconMenu && iconClose) {
                    iconMenu.classList.toggle('hidden');
                    iconClose.classList.toggle('hidden');
                }
            });
        }
    }
    // 导航栏滚动固定逻辑
    function initStickyNav() {
        const nav = document.getElementById('main-nav');
        if (!nav) return;
        // 创建占位符，防止页面跳动
        const placeholder = document.createElement('div');
        placeholder.style.display = 'none'; // 默认隐藏
        nav.parentNode.insertBefore(placeholder, nav);
        // 获取导航栏初始位置（缓存，假设初始在顶部或固定位置）
        // 注意：如果页面有顶部通栏，nav.offsetTop 可能不为0
        let navTop = nav.offsetTop;
        // 监听 resize 更新 navTop，防止布局变化导致位置不对
        window.addEventListener('resize', () => {
            if (!nav.classList.contains('fixed')) {
                navTop = nav.offsetTop;
            }
        });
        window.addEventListener('scroll', function () {
            const scrollY = window.scrollY;
            // 动态获取高度，确保准确
            // 优先获取内部固定高度的容器 (.h-20)，加上 border-bottom (1px)
            // 这样可以避免 mobile-menu 或 mega-menu 的 absolute 定位在某些情况下影响 nav 高度的问题
            const headerContent = nav.querySelector('.h-20');
            // 如果找不到 .h-20，回退到 nav.offsetHeight，但通常 .h-20 是存在的
            // nav border-b width is 1px
            const navHeight = headerContent ? (headerContent.offsetHeight + 1) : nav.offsetHeight;
            if (scrollY > (navTop + navHeight)) { // 当滚动超过导航栏原始底部位置时
                if (!nav.classList.contains('fixed')) { // 启用固定定位前设置占位符高度
                    placeholder.style.height = navHeight + 'px';
                    placeholder.style.display = 'block'; // 显示占位符

                    nav.classList.add('fixed', 'top-0', 'left-0', 'w-full', 'shadow-md', 'animate-slide-down');
                    nav.classList.remove('relative');
                }
            } else {
                if (nav.classList.contains('fixed')) { // 取消固定定位
                    nav.classList.remove('fixed', 'top-0', 'left-0', 'w-full', 'shadow-md', 'animate-slide-down');
                    nav.classList.add('relative');
                    placeholder.style.display = 'none'; // 隐藏占位符
                }
            }
        });
    }
    // 立即执行初始化
    (function () {
        // 延迟一点执行以确保 DOM 元素就绪（虽然脚本是在 HTML 解析时执行的，但保险起见）或者直接执行
        initMegaMenu();
        initMobileMenu();
        initMobileToggle();
        initStickyNav();
    })();
</script>